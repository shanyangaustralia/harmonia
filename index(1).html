<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Harmonia ‚Ä¢ Progressive Electronic Music Therapy</title>
<style>
  :root{
    --bg1:#5b2bbf; --bg2:#9f7aea; --card:#1e1633; --text:#f6f3ff; --muted:#cfc6ff;
    --accent:#ffd166; --accent-2:#5df2d6; --danger:#ff7a7a;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
    color:var(--text);
    background: radial-gradient(1200px 700px at 10% 10%, var(--bg2), transparent 60%),
                radial-gradient(1200px 700px at 90% 0%, #7f56d9, transparent 60%),
                linear-gradient(160deg, #2b164f 0%, #120a27 60%);
  }
  .container{max-width:1100px;margin:0 auto;padding:24px}
  header{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:16px 0 8px 0;}
  .brand{display:flex;align-items:center;gap:12px}
  .logo{width:40px;height:40px;border-radius:50%;background: conic-gradient(from 120deg, var(--accent), var(--accent-2), #a78bfa);box-shadow:0 0 12px #a78bfaaa, inset 0 0 12px #ffffff22;}
  h1{font-size:clamp(22px, 4vw, 32px); margin:0}
  .sub{color:var(--muted); margin:4px 0 0 0; font-size:14px}
  .card{background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:18px; padding:18px;box-shadow:0 6px 30px rgba(0,0,0,.25);backdrop-filter: blur(6px);}
  .hero{display:grid;grid-template-columns:1.1fr .9fr;gap:18px;align-items:stretch}
  @media (max-width:900px){.hero{grid-template-columns:1fr}}
  .btn{appearance:none; border:none; cursor:pointer; color:#131218; font-weight:700;
    padding:12px 16px; border-radius:12px; background:var(--accent);
    transition:transform .05s ease, box-shadow .2s ease; box-shadow:0 6px 20px rgba(255,209,102,.35);}
  .btn:is(:hover,:focus){transform:translateY(-1px)}
  .btn.secondary{background:#ffffff12;color:var(--text);border:1px solid #ffffff22;box-shadow:none}
  .btn.ghost{background:transparent;color:var(--text);border:1px dashed #ffffff35}
  .stack{display:flex;gap:10px;flex-wrap:wrap}
  .moods{display:flex;gap:10px;flex-wrap:wrap}
  .chip{border:1px solid #ffffff2a; padding:8px 12px; border-radius:999px; cursor:pointer; user-select:none;
    background:#ffffff10; color:var(--text); font-weight:600; font-size:14px;}
  .chip[data-active="true"]{background:var(--accent-2); color:#13201c; border-color:transparent}
  .panel{display:grid; gap:12px}
  .grid{display:grid; grid-template-columns: repeat( auto-fill, minmax(260px,1fr) ); gap:14px}
  .row{display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap}
  .small{font-size:12px;color:var(--muted)}
  footer{margin:30px 0; text-align:center; color:#bfb3ff}
  .pill{padding:6px 10px;border-radius:999px;background:#ffffff12;border:1px solid #ffffff22}
  textarea, select, input[type="text"], input[type="number"]{
    width:100%; background:#0f0a20; color:var(--text); border:1px solid #ffffff21; border-radius:10px; padding:10px;
  }
  label{font-size:13px;color:#dfd8ff}
  .rating{display:flex; gap:6px}
  .rating button{width:34px;height:34px;border-radius:10px;border:1px solid #ffffff2a;background:#ffffff10;color:var(--text);cursor:pointer}
  .rating button[data-active="true"]{background:var(--accent); color:#1a142e; border-color:transparent; font-weight:800}
  .hidden{display:none !important}
  iframe{border-radius:12px; width:100%; height:420px; border:0}
</style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Harmonia</h1>
          <div class="sub">Progressive electronic playlists for mood, focus, and calm.</div>
        </div>
      </div>
      <div class="stack">
        <!-- Opens Spotify login page in a new tab -->
        <a class="btn" href="https://accounts.spotify.com/en/login" target="_blank" rel="noopener">üîó Log in to Spotify</a>
        <span class="pill">No account needed for previews</span>
      </div>
    </header>

    <section class="hero">
      <div class="card panel">
        <h2 style="margin:0">Start a session</h2>
        <p class="small">Pick a mood. We‚Äôll load a fitting public playlist. You can play previews here or open in Spotify.</p>

        <div id="moodChips" class="moods"></div>

        <div class="row">
          <button id="recommendBtn" class="btn secondary">‚ú® Load Playlist</button>
          <span class="small">Tip: If you‚Äôre logged in on Spotify, ‚ÄúOpen in Spotify‚Äù will continue in your account.</span>
        </div>
      </div>

      <div class="card panel">
        <h3 style="margin:0">Session Settings</h3>
        <label for="tracksCount">How many tracks to list? (5‚Äì12)</label>
        <input id="tracksCount" type="number" min="5" max="12" value="8" />
        <label for="durationPref">Session vibe</label>
        <select id="durationPref">
          <option value="balanced" selected>Balanced</option>
          <option value="chill">Chill / low energy</option>
          <option value="focus">Deep focus</option>
          <option value="energize">Energize</option>
        </select>
        <p class="small">These control which playlist we embed.</p>
      </div>
    </section>

    <section id="results" class="panel" style="margin-top:18px">
      <div class="row">
        <h2 style="margin:0">Recommendations</h2>
        <span id="countBadge" class="pill hidden"></span>
      </div>
      <div id="embedWrap" class="panel"></div>
      <div id="trackLinks" class="grid"></div>
    </section>

    <section id="feedback" class="card panel hidden">
      <div class="row">
        <h3 style="margin:0">How was your session?</h3>
        <span class="small">We‚Äôd love your feedback.</span>
      </div>
      <div class="rating" id="rating"></div>
      <label for="fbTxt" style="margin-top:8px">Comments (optional)</label>
      <textarea id="fbTxt" rows="3" placeholder="Tell us what worked or what to improve‚Ä¶"></textarea>
      <div class="row">
        <button id="submitFb" class="btn">Send Feedback</button>
        <span id="fbMsg" class="small"></span>
      </div>
    </section>

    <footer>
      <div class="small">No Spotify account or API required. Feedback is stored locally in your browser.</div>
    </footer>
  </div>

<script>
/* ============ SIMPLE, NO-API MODE ============ */
const state = { mood: "relax", rating: 0 };

const moods = [
  { id:"relax", label:"Relax",   playlist:"37i9dQZF1DX7EF8wVxBVhG" }, // Peaceful Piano
  { id:"focus", label:"Focus",   playlist:"37i9dQZF1DXc8kgYqQLMfH" }, // Deep Focus
  { id:"energize", label:"Energize", playlist:"37i9dQZF1DX8FwnYE6PRvL" }, // Dance Rising
  { id:"uplift", label:"Uplift", playlist:"37i9dQZF1DX0UrRvztWcAU" },  // Feel Good
  { id:"sleep", label:"Sleep",   playlist:"37i9dQZF1DWZd79rJ6a7lp" }   // Sleep
];

function $(s){return document.querySelector(s)}
function el(tag, attrs={}, kids=[]){
  const e=document.createElement(tag);
  for (const [k,v] of Object.entries(attrs)){
    if(k==="class") e.className=v; else if(k==="html") e.innerHTML=v; else e.setAttribute(k,v);
  }
  (Array.isArray(kids)?kids:[kids]).forEach(c=> e.appendChild(typeof c==="string"?document.createTextNode(c):c));
  return e;
}

function renderMoods(){
  const wrap = $("#moodChips"); wrap.innerHTML="";
  moods.forEach(m=>{
    const chip = el("button",{class:"chip","data-id":m.id},m.label);
    chip.onclick=()=>{
      state.mood=m.id;
      [...wrap.children].forEach(c=>c.setAttribute("data-active", String(c===chip)));
    };
    chip.setAttribute("data-active", m.id===state.mood);
    wrap.appendChild(chip);
  });
}

function loadPlaylist(){
  const m = moods.find(x=>x.id===state.mood) || moods[0];
  // Embed public playlist (no login needed for 30s previews)
  $("#embedWrap").innerHTML = "";
  $("#embedWrap").appendChild(el("div",{html:
    `<iframe src="https://open.spotify.com/embed/playlist/${m.playlist}" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>`
  }));

  // Provide a direct "Open in Spotify" link
  const openUrl = `https://open.spotify.com/playlist/${m.playlist}`;
  const n = Math.max(5, Math.min(12, Number($("#tracksCount").value)||8));
  $("#countBadge").textContent = `Showing playlist ‚Ä¢ ~${n} tracks`;
  $("#countBadge").classList.remove("hidden");

  // Since we‚Äôre not using the API, just show one card that links out
  const grid = $("#trackLinks"); grid.innerHTML="";
  grid.appendChild(el("div",{class:"card"},[
    el("h3",{style:"margin:0 0 6px 0"},"Open in Spotify"),
    el("p",{class:"small"},"For full tracks and personalization, continue in Spotify."),
    el("a",{href:openUrl, target:"_blank", rel:"noopener", class:"btn ghost"},"Open Playlist")
  ]));

  showFeedback();
}

function renderRating(){
  const wrap = $("#rating"); wrap.innerHTML = "";
  for(let i=1;i<=5;i++){
    const b = el("button",{"data-val":i, "aria-label":`Rate ${i}`}, String(i));
    b.onclick = ()=>{
      state.rating = i;
      [...wrap.children].forEach(c=>c.setAttribute("data-active", String(c===b)));
    };
    wrap.appendChild(b);
  }
}
function showFeedback(){
  renderRating();
  $("#feedback").classList.remove("hidden");
}
function saveFeedback(){
  const fb = {
    ts: new Date().toISOString(),
    mood: state.mood,
    rating: state.rating,
    text: $("#fbTxt").value.trim()
  };
  if(!fb.rating){ $("#fbMsg").textContent = "Please choose a rating (1‚Äì5)."; return; }
  const key="harmonia_feedback";
  const list = JSON.parse(localStorage.getItem(key) || "[]");
  list.push(fb);
  localStorage.setItem(key, JSON.stringify(list));
  $("#fbMsg").textContent = "Thanks! Your feedback was saved locally.";
}

/* INIT */
(function init(){
  renderMoods();
  $("#recommendBtn").addEventListener("click", loadPlaylist);
  $("#submitFb").addEventListener("click", saveFeedback);
})();
</script>
</body>
</html>
