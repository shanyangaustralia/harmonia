<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Harmonia ‚Ä¢ Adaptive Music Therapy (YouTube)</title>
<style>
  :root{--bg1:#5b2bbf;--bg2:#9f7aea;--text:#f6f3ff;--muted:#cfc6ff;--accent:#ffd166;--accent2:#5df2d6}
  *{box-sizing:border-box} html,body{height:100%}
  body{
    margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;color:var(--text);
    background:radial-gradient(1200px 700px at 10% 10%,var(--bg2),transparent 60%),
               radial-gradient(1200px 700px at 90% 0%,#7f56d9,transparent 60%),
               linear-gradient(160deg,#2b164f 0%,#120a27 60%)}
  .container{max-width:1100px;margin:0 auto;padding:24px}
  header{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:12px 0}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:40px;height:40px;border-radius:50%;background:conic-gradient(from 120deg,var(--accent),var(--accent2),#a78bfa)}
  h1{margin:0;font-size:clamp(22px,4vw,32px)} .sub{color:var(--muted);font-size:14px;margin-top:4px}
  .card{background:#ffffff0a;border:1px solid #ffffff1a;border-radius:18px;padding:18px;backdrop-filter:blur(6px);box-shadow:0 6px 30px #0003}
  .hero{display:grid;grid-template-columns:1.1fr .9fr;gap:18px} @media(max-width:900px){.hero{grid-template-columns:1fr}}
  .btn{border:0;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer;background:var(--accent);color:#1c1830;box-shadow:0 6px 20px #ffd16655}
  .btn.secondary{background:#ffffff18;color:var(--text);border:1px solid #ffffff33;box-shadow:none}
  .chip{border:1px solid #ffffff33;background:#ffffff18;color:#f6f3ff;padding:8px 12px;border-radius:999px;cursor:pointer}
  .chip[data-active="true"]{background:var(--accent2);color:#10221d;border-color:transparent}
  .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
  .moods,.rating{display:flex;gap:10px;flex-wrap:wrap}
  .pill{padding:6px 10px;border-radius:999px;background:#ffffff12;border:1px solid #ffffff33}
  .small{font-size:12px;color:var(--muted)} .hidden{display:none!important}
  iframe{width:100%;height:420px;border:0;border-radius:12px;background:#000}
  select{width:100%;background:#0f0a20;color:#f6f3ff;border:1px solid #ffffff33;border-radius:10px;padding:10px}
</style>
</head>
<body>
<div class="container">
  <header>
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <h1>Harmonia</h1>
        <div class="sub">Adaptive mood music, powered by YouTube playlists.</div>
      </div>
    </div>
    <div class="row">
      <span class="pill">Full mixes via YouTube üéµ</span>
    </div>
  </header>

  <section class="hero">
    <div class="card">
      <h2 style="margin:0">Start a session</h2>
      <p class="small">Pick a mood and click ‚ÄúLoad Session‚Äù. Your feedback will adapt the next playlist.</p>
      <div id="moodChips" class="moods"></div>
      <div class="row" style="margin-top:8px">
        <button id="playBtn" class="btn">‚ú® Load Session</button>
      </div>
    </div>

    <div class="card">
      <h3 style="margin:0">Session settings</h3>
      <label for="vibe" class="small">Vibe tilt</label>
      <select id="vibe">
        <option value="balanced" selected>Balanced</option>
        <option value="chill">Chill / Low energy</option>
        <option value="focus">Deep Focus</option>
        <option value="energize">Energize</option>
      </select>
      <p class="small">We‚Äôll use this to choose the playlist flavor.</p>
    </div>
  </section>

  <section id="results" style="margin-top:18px" class="card">
    <div class="row" style="justify-content:space-between">
      <h2 style="margin:0">Now Playing</h2>
      <a id="openLink" class="btn secondary" href="https://music.youtube.com" target="_blank" rel="noopener">
        Open externally
      </a>
    </div>
    <div id="embedWrap" style="margin-top:10px"></div>
    <p id="hint" class="small" style="margin-top:6px"></p>
  </section>

  <section id="feedback" class="card hidden" style="margin-top:14px">
    <div class="row" style="justify-content:space-between">
      <h3 style="margin:0">How did that feel?</h3>
      <span class="small">Your feedback changes what plays next.</span>
    </div>
    <div class="rating" style="margin-top:8px">
      <button class="btn" data-rate="good">üëç Good</button>
      <button class="btn secondary" data-rate="moderate">üòê Moderate</button>
      <button class="btn secondary" data-rate="bad">üëé Not for me</button>
    </div>
    <p id="fbMsg" class="small" style="margin-top:8px"></p>
  </section>

  <footer style="text-align:center;margin:28px 0" class="small">
    ¬© Harmonia ‚Äî feedback stored locally (no accounts, no tracking).
  </footer>
</div>

<script>
/* ==================== PLAYLIST / VIDEO PRESETS ====================
   type: "playlist" uses /embed/videoseries?list=ID
   type: "video"    uses /embed/VIDEO_ID
   All IDs below come from normal YouTube URLs:
   - Playlist: https://www.youtube.com/playlist?list=ID
   - Video:    https://www.youtube.com/watch?v=ID
*/
const presets = {
  relax: {
    base: {
      balanced: [
        {type:"playlist", id:"PLhcTrmOrq3ZF6RXoiM_cy3efgtqpqGf63"} // Chillout - Ambient - Electronic
      ],
      chill: [
        {type:"video", id:"94oRUmQqQQ8"} // Ambient Music ‚Äì Unplug and De Stress
      ],
      focus: [
        {type:"playlist", id:"PLqeS6IFyLPkdXAcPU_sGhJEObT2gQODAb"} // Deep Focus Music
      ],
      energize: [
        {type:"playlist", id:"PLhcTrmOrq3ZF6RXoiM_cy3efgtqpqGf63"}
      ]
    },
    good: [
      {type:"playlist", id:"PLhcTrmOrq3ZF6RXoiM_cy3efgtqpqGf63"}
    ],
    moderate: [
      {type:"video", id:"QluZQaGJZ6A"}  // Ambient Downtempo Chillout
    ],
    bad: [
      {type:"video", id:"wreqz7dTGOk"}  // Lullaby for the Sun ‚Äì full album
    ]
  },

  focus: {
    base: {
      balanced: [
        {type:"playlist", id:"PLNIOIzEHtNJbXCOTAlbxazG1MwruX0Rg5"}, // Newest Study & Deep Focus
        {type:"playlist", id:"PLqeS6IFyLPkdXAcPU_sGhJEObT2gQODAb"}
      ],
      chill: [
        {type:"video", id:"5OhPNn_tIyY"}  // Ambient Study Music
      ],
      focus: [
        {type:"playlist", id:"PLqeS6IFyLPkdXAcPU_sGhJEObT2gQODAb"}
      ],
      energize: [
        {type:"video", id:"DfSkKYQiwoU"}  // Deep Focus 12 hours
      ]
    },
    good: [
      {type:"playlist", id:"PLNIOIzEHtNJbXCOTAlbxazG1MwruX0Rg5"}
    ],
    moderate: [
      {type:"video", id:"d7vbPEDfLc8"}
    ],
    bad: [
      {type:"video", id:"94oRUmQqQQ8"}
    ]
  },

  energize: {
    base: {
      balanced: [
        {type:"playlist", id:"PLEtgZKznQZq3gDLX0k8I_cxPfmQZeNo7s"}, // Uplifting Trance
        {type:"playlist", id:"PLEReeFFcbzQzsdNMhG2drDRH3CWbrZcQ3"}  // Uplifting Trance Playlist
      ],
      chill: [
        {type:"video", id:"QluZQaGJZ6A"}
      ],
      focus: [
        {type:"playlist", id:"PL_rzAzPDIGoX53OjZ-ltGzBnPDGfFVkxe"}  // Uplifting Trance Releases
      ],
      energize: [
        {type:"video", id:"8xDPdgAaE4o"} // Uplifting Trance 2024 full album
      ]
    },
    good: [
      {type:"video", id:"k05N55YCw_g"},
      {type:"video", id:"3x9U3te83yk"}
    ],
    moderate: [
      {type:"playlist", id:"PLEtgZKznQZq3gDLX0k8I_cxPfmQZeNo7s"}
    ],
    bad: [
      {type:"video", id:"94oRUmQqQQ8"}
    ]
  },

  uplift: {
    base: {
      balanced: [
        {type:"playlist", id:"PLEReeFFcbzQzsdNMhG2drDRH3CWbrZcQ3"}
      ],
      chill: [
        {type:"video", id:"agDCGOSKQSI"} // Chillout album
      ],
      focus: [
        {type:"playlist", id:"PLNIOIzEHtNJbXCOTAlbxazG1MwruX0Rg5"}
      ],
      energize: [
        {type:"video", id:"3x9U3te83yk"}
      ]
    },
    good: [
      {type:"video", id:"8xDPdgAaE4o"}
    ],
    moderate: [
      {type:"video", id:"QluZQaGJZ6A"}
    ],
    bad: [
      {type:"video", id:"94oRUmQqQQ8"}
    ]
  },

  sleep: {
    base: {
      balanced: [
        {type:"video", id:"94oRUmQqQQ8"}, // ambient relax
        {type:"video", id:"94oRUmQqQQ8"}
      ],
      chill: [
        {type:"video", id:"94oRUmQqQQ8"}
      ],
      focus: [
        {type:"video", id:"94oRUmQqQQ8"}
      ],
      energize: [
        {type:"video", id:"94oRUmQqQQ8"}
      ]
    },
    good: [
      {type:"video", id:"94oRUmQqQQ8"}
    ],
    moderate: [
      {type:"video", id:"wreqz7dTGOk"}
    ],
    bad: [
      {type:"video", id:"5OhPNn_tIyY"}
    ]
  }
};

/* ==================== HELPERS & STATE ==================== */
const $ = s => document.querySelector(s);
const state = { mood:"relax" };

function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

function buildEmbed(item){
  if(item.type === "playlist"){
    const embed = `https://www.youtube.com/embed/videoseries?list=${item.id}&autoplay=1`;
    const openYt  = `https://www.youtube.com/playlist?list=${item.id}`;
    const openYtm = `https://music.youtube.com/playlist?list=${item.id}`;
    return {embed, openYt, openYtm};
  }else{
    const embed = `https://www.youtube.com/embed/${item.id}?autoplay=1`;
    const openYt  = `https://www.youtube.com/watch?v=${item.id}`;
    const openYtm = `https://music.youtube.com/watch?v=${item.id}`;
    return {embed, openYt, openYtm};
  }
}

/* ==================== EMBED CORE ==================== */
function embedFromList(list){
  const item = pick(list);
  const {embed, openYt, openYtm} = buildEmbed(item);
  const wrap = $("#embedWrap");
  wrap.innerHTML = `
    <iframe
      src="${embed}"
      allow="autoplay; encrypted-media; picture-in-picture"
      allowfullscreen
      referrerpolicy="origin-when-cross-origin"
    ></iframe>
    <p class="small">
      If playback is restricted in your region, 
      <a href="${openYt}" target="_blank" rel="noopener">open on YouTube</a> or 
      <a href="${openYtm}" target="_blank" rel="noopener">YouTube Music</a>.
    </p>
  `;
  $("#openLink").href = openYtm;
}

/* Get base list for current mood/vibe */
function baseList(){
  const vibe = $("#vibe").value;
  const base = presets[state.mood].base;
  return base[vibe] || base.balanced;
}

/* ==================== UI + LOGIC ==================== */
function renderMoods(){
  const wrap=$("#moodChips"); wrap.innerHTML="";
  ["relax","focus","energize","uplift","sleep"].forEach(id=>{
    const b=document.createElement("button");
    b.className="chip"; b.textContent=id[0].toUpperCase()+id.slice(1);
    b.onclick=()=>{ state.mood=id; [...wrap.children].forEach(c=>c.dataset.active=String(c===b)); };
    if(id===state.mood) b.dataset.active="true";
    wrap.appendChild(b);
  });
}

function loadBase(){
  embedFromList(baseList());
  $("#hint").textContent = "Enjoy! Then rate below to adapt the next playlist.";
  $("#feedback").classList.remove("hidden");
}

function adapt(sentiment){
  const list = presets[state.mood][sentiment];
  embedFromList(list);
  $("#hint").textContent =
    sentiment==="good" ? "Nice ‚Äî we‚Äôve leaned further into that vibe üé∂"
    : sentiment==="moderate" ? "Adjusted slightly to better match your taste."
    : "Switching to a different flavor for you.";
  const key="harmonia_feedback_youtube";
  const hist = JSON.parse(localStorage.getItem(key) || "[]");
  hist.push({ts:new Date().toISOString(), mood:state.mood, vibe:$("#vibe").value, sentiment});
  localStorage.setItem(key, JSON.stringify(hist));
  $("#fbMsg").textContent = "Feedback saved locally.";
}

/* ==================== INIT ==================== */
renderMoods();
$("#playBtn").addEventListener("click", loadBase);
document.querySelectorAll('[data-rate]').forEach(b=>b.addEventListener("click",()=> adapt(b.dataset.rate)));
</script>
</body>
</html>
